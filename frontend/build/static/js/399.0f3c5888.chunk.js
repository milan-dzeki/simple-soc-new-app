"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[399],{9596:function(e,t,n){var o=n(1243),r=n(8006),a=o.Z.create({baseURL:"".concat(r.Z,"/photoAlbum")});t.Z=a},2942:function(e,t,n){n.d(t,{Z:function(){return c}});var o={container:"pageContainer_container__JU78m",container__flex:"pageContainer_container__flex__mQNaW",container__data:"pageContainer_container__data__70LWJ",big:"pageContainer_big__iMyUq"},r={title:"pageTitle_title__Di7Rk",title__text:"pageTitle_title__text__jkIUE",title__underline:"pageTitle_title__underline__A2NOq"},a=n(184),s=function(e){return(0,a.jsxs)("div",{className:"".concat(r.title," ").concat(r[e.textAlign]),children:[(0,a.jsx)("h1",{className:r.title__text,children:e.titleText}),(0,a.jsx)("div",{className:r.title__underline})]})},c=function(e){return(0,a.jsxs)("main",{className:"".concat(o.container," ").concat(o[e.display]," ").concat(o[e.width]),children:[e.hasPageTitle&&e.titleText&&e.titleTextAlign&&(0,a.jsx)(s,{titleText:e.titleText,textAlign:e.titleTextAlign}),(0,a.jsx)("section",{className:o.container__data,children:e.children})]})}},5399:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var o=n(3433),r=n(1413),a=n(4165),s=n(5861),c=n(9439),i=n(2791),l=n(7689),u=n(9596),m=n(2942),p={photo:"singlePhoto_photo__evm5X",photo__img:"singlePhoto_photo__img__k-DOc",photo__info:"singlePhoto_photo__info__unU3K",photo__user:"singlePhoto_photo__user__iKR6y",photo__user_img:"singlePhoto_photo__user_img__9Zy86",photo__user_name:"singlePhoto_photo__user_name__lLj7O",photo__user_created:"singlePhoto_photo__user_created__mMoWq"},d=n(6220),h=n(2186),_=n(1334),f=n(4079),g=n(184),x=function(e){return(0,g.jsxs)("div",{className:p.photo,children:[(0,g.jsx)("div",{className:p.photo__img,children:(0,g.jsx)("img",{src:e.photo.photo.secure_url,alt:"photo_user"})}),(0,g.jsxs)("div",{className:p.photo__info,children:[(0,g.jsxs)("div",{className:p.photo__user,children:[(0,g.jsx)("div",{className:p.photo__user_img,children:(0,g.jsx)("img",{src:e.photoUser.profilePhotoUrl||d,alt:"user"})}),(0,g.jsxs)("div",{className:p.photo__user_info,children:[(0,g.jsx)("p",{className:p.photo__user_name,children:e.photoUser.fullName}),(0,g.jsx)("p",{className:p.photo__user_created,children:(0,h.X)(e.photo.createdAt)})]})]}),e.loading?(0,g.jsx)(f.Z,{}):(0,g.jsx)(_.Z,{itemId:e.photo._id,comments:e.photo.comments,likes:e.photo.likes,onSubmitComment:e.onCommentOnPhoto,onLikeItem:e.onLikePhoto,onUnlikeItem:e.onUnlikePhoto,onLikeComment:e.onLikePhotoComment,onUnlikeComment:e.onUnlikePhotoComment,onPrepareDeleteComment:e.onPrepareDeletePhotoComment})]})]})},k=n(5155),Z=n(5582),b=function(){var e=(0,l.UO)(),t=e.albumId,n=e.photoId,p=(0,i.useState)(!1),d=(0,c.Z)(p,2),h=d[0],_=d[1],f=(0,i.useState)(null),b=(0,c.Z)(f,2),I=(b[0],b[1]),v=(0,i.useState)(null),C=(0,c.Z)(v,2),T=C[0],P=C[1],j=(0,i.useState)(null),N=(0,c.Z)(j,2),w=N[0],A=N[1],y=(0,i.useState)({albumId:null,photoId:null,commentId:null}),U=(0,c.Z)(y,2),S=U[0],L=U[1],z=(0,i.useCallback)((0,s.Z)((0,a.Z)().mark((function e(){var o,r,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(!0),t&&n){e.next=3;break}return e.abrupt("return",I("Photo not found. Maybe it was deleted in the meantime."));case 3:return o=localStorage.getItem("socNetAppToken"),e.prev=4,e.next=7,u.Z.get("/photo/".concat(t,"/").concat(n),{headers:{Authorization:"Bearer ".concat(o)}});case 7:r=e.sent,s=r.data,A(s.photo),P(s.user),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),I(e.t0.response.data.message);case 16:_(!1);case 17:case"end":return e.stop()}}),e,null,[[4,13]])}))),[t,n]);(0,i.useEffect)((function(){z()}),[z]);var B=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n,s,c,i){var l,m,p,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return I("Can't locate photo album id. Try refreshing the page"),e.abrupt("return");case 3:if(0!==s.trim().length||c||0!==i.length){e.next=6;break}return I("Comment requires at least text, photo or 1 tagged friend."),e.abrupt("return");case 6:return(l=new FormData).append("albumId",t),l.append("commentText",s),l.append("photoId",w._id),c&&l.append("commentPhoto",c),l.append("taggs",JSON.stringify(i)),m=localStorage.getItem("socNetAppToken"),e.prev=13,e.next=16,u.Z.post("/photoComment",l,{headers:{Authorization:"Bearer ".concat(m),"Content-Type":"multipart/form-data"}});case 16:p=e.sent,d=p.data,console.log(d),A((function(e){return e?(0,r.Z)((0,r.Z)({},e),{},{comments:[d.newComment].concat((0,o.Z)(e.comments))}):e})),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),I(e.t0.response.data.message);case 25:case"end":return e.stop()}}),e,null,[[13,22]])})));return function(t,n,o,r){return e.apply(this,arguments)}}(),O=(0,i.useCallback)((function(e,n){t?L({albumId:t,photoId:e,commentId:n}):I("Album not found. Try refreshing the page")}),[t]),D=(0,i.useCallback)((function(){L({albumId:null,photoId:null,commentId:null})}),[]),q=(0,i.useCallback)((0,s.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.albumId&&S.photoId&&S.commentId){e.next=3;break}return I("Comment not found. Try refreshing the page"),e.abrupt("return");case 3:return t=localStorage.getItem("socNetAppToken"),_(!0),e.prev=5,e.next=8,u.Z.delete("/photoComment/".concat(S.albumId,"/").concat(S.photoId,"/").concat(S.commentId),{headers:{Authorization:"Bearer ".concat(t)}});case 8:A((function(e){return e?(0,r.Z)((0,r.Z)({},e),{},{comments:e.comments.filter((function(e){return e._id!==S.commentId}))}):e})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),I(e.t0.response.data.message);case 14:_(!1),L({albumId:null,photoId:null,commentId:null});case 16:case"end":return e.stop()}}),e,null,[[5,11]])}))),[S]),M=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var n,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("socNetAppToken"),e.prev=1,e.next=4,u.Z.post("/photo/like",{albumId:t,photoId:w._id},{headers:{Authorization:"Bearer ".concat(n)}});case 4:s=e.sent,c=s.data,A((function(e){return e?(0,r.Z)((0,r.Z)({},e),{},{likes:[c.userLiked].concat((0,o.Z)(e.likes))}):e})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),I(e.t0.response.data.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(){var n,o,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("socNetAppToken"),e.prev=1,e.next=4,u.Z.post("/photo/unlike",{albumId:t,photoId:w._id},{headers:{Authorization:"Bearer ".concat(n)}});case 4:o=e.sent,s=o.data,A((function(e){return e?(0,r.Z)((0,r.Z)({},e),{},{likes:e.likes.filter((function(e){return e._id!==s.userUnlikedId}))}):e})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),I(e.t0.response.data.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n,s){var c,i,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=localStorage.getItem("socNetAppToken"),console.log(s),e.prev=2,e.next=5,u.Z.post("/photoCommentLike",{albumId:t,photoId:n,commentId:s},{headers:{Authorization:"Bearer ".concat(c)}});case 5:i=e.sent,l=i.data,console.log(l),A((function(e){if(!e)return e;var t=e.comments.findIndex((function(e){return e._id===s}));if(t<0)return e;var n=(0,o.Z)(e.comments);return n[t].likes.unshift(l.userLiked),(0,r.Z)((0,r.Z)({},e),{},{comments:n})})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),I(e.t0.response.data.message);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t,n){var s,c,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=localStorage.getItem("socNetAppToken"),e.prev=1,e.next=4,u.Z.post("/photoCommentUnlike",{commentId:n},{headers:{Authorization:"Bearer ".concat(s)}});case 4:c=e.sent,i=c.data,console.log(i),A((function(e){if(!e)return e;var t=e.comments.findIndex((function(e){return e._id===n}));if(t<0)return e;var a=(0,o.Z)(e.comments),s=e.comments[t].likes.filter((function(e){return e._id!==i.userUnlikedId}));return a[t].likes=s,(0,r.Z)((0,r.Z)({},e),{},{comments:a})})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),I(e.t0.response.data.message);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,g.jsxs)(g.Fragment,{children:[null!==S.albumId&&null!==S.photoId&&null!==S.commentId&&(0,g.jsxs)(k.default,{isErrorModal:!1,show:null!==S.albumId&&null!==S.photoId&&null!==S.commentId,title:"Prepairing to delete comment",text:"Are you sure you want to delete this comment?",onClose:D,children:[(0,g.jsx)(Z.Z,{btnType:"button",btnCustomType:"btn__cancel",btnText:"cancel",onClick:D}),(0,g.jsx)(Z.Z,{btnType:"button",btnCustomType:"btn__confirm",btnText:"delete",onClick:q})]}),(0,g.jsx)(m.Z,{display:"container__block",loading:h,width:"big",hasPageTitle:!1,children:w&&T&&(0,g.jsx)(x,{photo:w,loading:h,photoUser:T,onLikePhoto:M,onUnlikePhoto:E,onLikePhotoComment:J,onUnlikePhotoComment:R,onCommentOnPhoto:B,onPrepareDeletePhotoComment:O})})]})}}}]);
//# sourceMappingURL=399.0f3c5888.chunk.js.map